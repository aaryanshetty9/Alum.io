from pymongo import MongoClient
from dotenv import load_dotenv
import os
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.chrome.options import Options
import tempfile
from dotenv import load_dotenv
import json
from pydantic import BaseModel
import requests
from time import sleep
from typing import Dict, List, Optional


load_dotenv()

client = MongoClient(os.getenv('MONGO_URI'))
db = client['AlumIO']
alumni_collection = db['alumni']



school_name = "Northeastern University"  # Change based on your need


Raw = {'apple': [{'name': 'Livia Sanjeev Gonsalves', 'title': 'Site Reliability Engineer at Apple', 'email': 'lgonsalves@apple.com'}, {'name': 'Kanachi W.', 'title': 'Software Engineer @Apple | Computer Engineering, Data Science @ Northeastern University', 'email': 'kw@apple.com'}, {'name': 'Pranjal Rane', 'title': 'Software Engineer @ Apple | MS CS @ Northeastern University', 'email': 'prane@apple.com'}, {'name': 'Priyank Sanjay', 'title': 'Staff Software Engineer at Apple', 'email': 'psanjay@apple.com'}, {'name': 'Pulkit J.', 'title': 'Software Engineer at Apple', 'email': 'pj@apple.com'}, {'name': 'Saad Mobarak', 'title': 'MechE @ Northeastern | prev @ Apple & Tesla', 'email': 'smobarak@apple.com'}, {'name': 'Xikai Liu', 'title': 'Software Engineer @ Apple', 'email': 'xliu@apple.com'}, {'name': 'Reza Asadi', 'title': 'Staff Software Engineer at Apple', 'email': 'rasadi@apple.com'}, {'name': 'Dhanisha Phadate', 'title': 'SRE @ Apple \uf8ff', 'email': 'dphadate@apple.com'}, {'name': 'Juan Garibay Atef', 'title': 'Finance Student at Northeastern University', 'email': 'jgaribayatef@apple.com'}, {'name': 'Ryan Tsai', 'title': 'SWE Intern @ Apple | CS @ Northeastern University', 'email': 'rtsai@apple.com'}, {'name': 'Sam Scroggie', 'title': 'Camera Process Engineer @ Apple | Stamps Scholar @ Northeastern University', 'email': 'sscroggie@apple.com'}], 'microsoft': [{'name': 'Sydney Nguyen', 'title': 'CS + Cognitive Science @ Northeastern', 'email': 'sydney.nguyen@microsoft.com'}, {'name': 'Varsha Jain', 'title': 'Software Engineer II at Microsoft', 'email': 'varsha.jain@microsoft.com'}, {'name': 'Ankit Masrani', 'title': 'Principal Engineer at Microsoft', 'email': 'ankit.masrani@microsoft.com'}, {'name': 'Wendi O.', 'title': 'SWE @ Microsoft', 'email': 'wendi.o@microsoft.com'}, {'name': 'Sekou Samassi', 'title': 'Incoming Explore Intern @ Microsoft | CS + Design @ Northeastern University | Rales Scholar', 'email': 'sekou.samassi@microsoft.com'}, {'name': 'Akshay Relekar', 'title': 'Software Engineer 2 at Microsoft', 'email': 'akshay.relekar@microsoft.com'}, {'name': 'Cindy Chen', 'title': 'CS @ NEU | Incoming SWE Co-op @ UEI | Incoming SWE Intern @ Microsoft', 'email': 'cindy.chen@microsoft.com'}, {'name': 'Isabel B.', 'title': 'Product at Microsoft', 'email': 'isabel.b@microsoft.com'}, {'name': 'Shakti Chetan Rao', 'title': 'Software Engineer @ Microsoft | Ex-Amazon | Kubernetes |', 'email': 'shakti.rao@microsoft.com'}, {'name': 'Deepak Sharma', 'title': 'Software Developer II at Microsoft', 'email': 'deepak.sharma@microsoft.com'}, {'name': 'Gaurav A.', 'title': 'Principal Software Engineer at Microsoft Teams, Ex-Salesforce, Ex-Amazon', 'email': 'gaurav.a@microsoft.com'}, {'name': 'Yishu Xu', 'title': 'Senior SDE at Azure SQL; actively looking for new opportunities', 'email': 'yishu.xu@microsoft.com'}], 'google': [{'name': 'Sunjit Dhillon', 'title': 'Software Engineer @Google', 'email': 'sdhillon@google.com'}, {'name': 'Emiliano (Zhenfang) Zhu', 'title': 'Software Engineer at Google | Cloud Billing', 'email': 'ezhu@google.com'}, {'name': 'Abdoul-hanane Gbadamassi', 'title': 'SWE,ML @Google | Master in CS at Northeastern University | x-Bloomberg SWE | x-Google TnS YouTube Monetization Data & Insight Intern | x-Data Science + CS at Claremont McKenna College', 'email': 'agbadamassi@google.com'}, {'name': 'Palak Mundra', 'title': 'ðŸš€ Cloud Solutions Architect | Software Engineer | Multi-Cloud Expert | Driving Innovation and Automation', 'email': 'pmundra@google.com'}, {'name': 'Shivam Thakur', 'title': 'Software and ML at Google Cloud', 'email': 'sthakur@google.com'}, {'name': 'Parshva Timbadia', 'title': 'Software Engineer @Google | Ex-SWE @Meta,CarGurus', 'email': 'ptimbadia@google.com'}, {'name': 'Neha Shewani', 'title': 'Software Engineer at Google', 'email': 'nshewani@google.com'}, {'name': 'Diego Rivas', 'title': 'Senior Product Manager at Google', 'email': 'drivas@google.com'}, {'name': 'Xiaomai C.', 'title': 'User Experience Researcher, Gemini @Vertex AI', 'email': 'xc@google.com'}, {'name': 'Sydney Bao', 'title': 'Incoming SWE Intern at Google | Computer Science and Design @ Northeastern University', 'email': 'sbao@google.com'}, {'name': 'Aishwarya Murali', 'title': 'Software Engineer | Android', 'email': 'amurali@google.com'}, {'name': 'Shubham Bhagwat', 'title': 'Cloud @ Google | Ex-BMW Group | MS Data Science @Northeastern University', 'email': 'sbhagwat@google.com'}], 'amazon': [{'name': 'Varun Morishetty', 'title': 'SDE @ Amazon | CS @ Northeastern University', 'email': 'morishettyv@amazon.com'}, {'name': 'Kanika Makhija', 'title': 'Software Development Engineer at Amazon Web Services (AWS)', 'email': 'makhijak@amazon.com'}, {'name': 'Shravya Cherukuri', 'title': 'Frontend Engineer @ AWS | UX Designer | Salesforce Certified', 'email': 'cherukuris@amazon.com'}, {'name': 'Akarsh C.', 'title': 'SDE @ Amazon Prime Video | CS @ Northeastern University | Android | Cloud | AI', 'email': 'cakarsh@amazon.com'}, {'name': 'Chetan Nigudgi', 'title': 'Software Dev Engineer | AWS | Northeastern University Alumni', 'email': 'nigudgic@amazon.com'}, {'name': 'Simran Goindani', 'title': "Data Scientist at AWS | Amazon | MFS Investment Management | Master's Graduate in Data Science from Northeastern University | Data Science | Machine Learning | Artificial Intelligence", 'email': 'goindanis@amazon.com'}, {'name': 'Swati Bhojwani', 'title': 'Software Development Engineer || , AWS | Graduate Teaching Assistant | #GHC20 | Northeastern University 2021 | Ex-Lead Software Developer | JAVA,J2EE | SPRING | HIBERNATE | NODEJS | RUST', 'email': 'bhojwanis@amazon.com'}, {'name': 'Sarthak Grover', 'title': 'Software Development Engineer II at Amazon', 'email': 'grovers@amazon.com'}, {'name': 'Sameer Singh', 'title': 'Software at AWS | Northeastern', 'email': 'singhs@amazon.com'}, {'name': 'Arvind Sudheer', 'title': 'SDE @ Amazon | Northeastern University', 'email': 'sudheera@amazon.com'}, {'name': 'Siddhanth Jayaraj Ajri', 'title': 'SDE @ Amazon | Prev: @Oracle, @Unqork | Northeastern Alum', 'email': 'ajris@amazon.com'}, {'name': 'Prabhpreet Singh Dhillon', 'title': 'Amazon | SDE | Northeastern University | MS Computer Science | Class of 2020', 'email': 'dhillonp@amazon.com'}], 'meta': [{'name': 'Manan Patel', 'title': 'Senior Software Engineer at Meta | Ex Google & AWS', 'email': 'manan@fb.com'}, {'name': 'Jing Fu', 'title': 'Software engineer at Meta', 'email': 'jing@fb.com'}, {'name': 'Shitan(Stan) Yang', 'title': 'Software Engineer at Meta', 'email': 'shitan@fb.com'}, {'name': 'Shubham Muttepawar', 'title': 'Senior Software Engineer at Meta | Distributed Systems', 'email': 'shubham@fb.com'}, {'name': 'Walker S.', 'title': 'Software Engineer @ Meta', 'email': 'walker@fb.com'}, {'name': 'Lingmiao Emma Q.', 'title': 'Engineering @ Meta', 'email': 'lingmiao@fb.com'}, {'name': 'Yue Liu', 'title': 'Manager, AR AI at Meta', 'email': 'yue@fb.com'}, {'name': 'Abhilash Mysore Somashekar', 'title': 'Engineering @ Meta', 'email': 'abhilash@fb.com'}, {'name': 'Hari Panjwani', 'title': 'Facebook | AWS | Ads Infra | Java & Spark | NLP | Distributed Systems', 'email': 'hari@fb.com'}, {'name': 'Praveen Kumar Sridhar', 'title': 'Machine Learning @ Meta | Ex-[Nextdoor, Citizen] | NLP Research @ NEU', 'email': 'praveen@fb.com'}, {'name': 'Nimesh Rajal', 'title': 'Data Engineer @ Meta | Data Engineer', 'email': 'nimesh@fb.com'}, {'name': 'Sally Wang', 'title': 'Web Developer | Full-stack | Alumni at Northeastern University', 'email': 'sally@fb.com'}], 'nvidia': [{'name': 'Myrna V.', 'title': 'Data Scientist at NVIDIA', 'email': 'mv@nvidia.com'}, {'name': 'Kenneth Le', 'title': 'SOX Compliance Analyst at NVIDIA', 'email': 'kle@nvidia.com'}, {'name': 'Anubhuti V.', 'title': 'Software Engineer | Nvidia', 'email': 'av@nvidia.com'}, {'name': 'Ajay Sureka', 'title': 'Senior Software Engineer @ NVIDIA || Full Stack Developer || Embedded Software Engineer || JAVA || SpringBoot || React || JavaScript || AWS || Distributed Systems', 'email': 'asureka@nvidia.com'}, {'name': 'Mert Bozbeyoglu', 'title': 'Firmware Engineer @ NVIDIA', 'email': 'mbozbeyoglu@nvidia.com'}, {'name': 'Andrew Tu', 'title': 'Senior Software Engineer, 3D Mapping | NVIDIA', 'email': 'atu@nvidia.com'}, {'name': 'Blake McHale', 'title': 'Robotics Systems Software Engineer at NVIDIA', 'email': 'bmchale@nvidia.com'}, {'name': 'Fengqi Qiao', 'title': 'SWE @ Nvidia', 'email': 'fqiao@nvidia.com'}, {'name': 'Suhas Maddali', 'title': 'Data Scientist @ NVIDIA | Large Language Models (LLMs) | Generative AI | MS in Data Science', 'email': 'smaddali@nvidia.com'}, {'name': 'Sanjana K.', 'title': 'Software Engineer', 'email': 'sk@nvidia.com'}, {'name': 'Xuangui Huang', 'title': 'AI DevTech Engineer @NVIDIA | CS Theory PhD @Northeastern | CS MS, BS @SJTU', 'email': 'xhuang@nvidia.com'}, {'name': 'Curt Lockhart', 'title': 'Senior AI Solutions Architect at NVIDIA', 'email': 'clockhart@nvidia.com'}], 'tesla-motors': [{'name': 'Siddhartha Bariker', 'title': 'Engineer @ Tesla', 'email': 'sbariker@tesla.com'}, {'name': 'Divya Bhupinder Suri', 'title': "SDE II @ Tesla | Former Software Engineer at Rockmetric | Graduate Student at Northeastern University '24 | AWS Certified Cloud Practitioner", 'email': 'dsuri@tesla.com'}, {'name': 'Sindhya Balasubramanian', 'title': 'Data Scientist | Expertise in Machine Learning, Time Series Analysis, and NLP | MS in Data Science', 'email': 'sbalasubramanian@tesla.com'}, {'name': 'Samarth Gowdra Shashi Kiran', 'title': 'Software Product Manager Intern @ Tesla | Driving User-Centric Innovation from Concept to Launch | MS Engineering Management student @ Northeastern University', 'email': 'sgowdrashashikiran@tesla.com'}, {'name': 'Pranamya .', 'title': 'Tesla | Northeastern University', 'email': 'p@tesla.com'}, {'name': 'Grant Ritter', 'title': 'Senior Mechanical Design Engineer at Tesla Design Studio', 'email': 'gritter@tesla.com'}, {'name': 'Niyati Khandelwal', 'title': 'Software Engineer @ Tesla | Prev @ Lumen, IBM | Full Stack Developer | MSCS @ Northeastern University, Khoury College of Computer Sciences', 'email': 'nkhandelwal@tesla.com'}, {'name': 'Aditya A.', 'title': "Sr. Logistics Data Analyst at Tesla | Master's Degree at Northeastern University", 'email': 'aa@tesla.com'}, {'name': 'Mark Wang', 'title': 'Sr Data Scientist at Tesla', 'email': 'mwang@tesla.com'}, {'name': 'Jamie P.', 'title': 'Product Intern @ Tesla | Prev. Microsoft', 'email': 'jp@tesla.com'}, {'name': 'Lillian Lema', 'title': 'Material Planning Intern @ Tesla | MPS Graduate Student at Northeastern University', 'email': 'llema@tesla.com'}, {'name': 'Joshua Joseph', 'title': 'Manufacturing Process @ Tesla', 'email': 'jjoseph@tesla.com'}], 'ibm': [{'name': 'Thierno Ahamadou Bah', 'title': 'IBM Software Developer | Computer Science Alumni at Northeastern University', 'email': 't.bah@ibm.com'}, {'name': 'Aly Badary', 'title': 'DevOps Developer @ IBM', 'email': 'a.badary@ibm.com'}, {'name': 'Maddison Niebling', 'title': 'Consultant @ IBM | 4x Salesforce Certified', 'email': 'm.niebling@ibm.com'}, {'name': 'Ben Wolpert', 'title': 'Consultant at IBM', 'email': 'b.wolpert@ibm.com'}, {'name': 'Sriram Voruganti', 'title': 'Software Developer at IBM || Graduate @ Northeastern || BITS Pilani', 'email': 's.voruganti@ibm.com'}, {'name': 'Aiyan Jiang', 'title': 'SWE @ IBM | CS @ Northeastern', 'email': 'a.jiang@ibm.com'}, {'name': 'Akshay Dangare', 'title': 'Staff Software Engineer @ IBM | Cloud Infrastructure', 'email': 'a.dangare@ibm.com'}, {'name': 'Habeebuddin Mir', 'title': 'Software Developer at IBM', 'email': 'h.mir@ibm.com'}, {'name': 'Asha Padmashetti', 'title': 'Staff Software Developer @IBM', 'email': 'a.padmashetti@ibm.com'}, {'name': 'Ankur Verma', 'title': 'Staff Software Engineer at IBM', 'email': 'a.verma@ibm.com'}, {'name': 'Tobias Barker', 'title': 'Associate Consultant at IBM', 'email': 't.barker@ibm.com'}, {'name': 'Alexander Wu', 'title': 'Consultant @ IBM | 8x Salesforce Certified', 'email': 'a.wu@ibm.com'}]}
# Format Data for MongoDB


def add_data_to_db(school_name, Raw):
    formatted_data = {
        "school": school_name,
        "companies": [{"name": company, "employees": employees} for company, employees in Raw.items()]
    }

    alumni_collection.insert_one(formatted_data)
    print('Data Saved')